{
 "name": "fabric-contract",
 "description": " ",
 "version": "1.0.0",
 "type": "flogo:app",
 "appModel": "1.0.0",
 "resources": [
  {
   "id": "flow:Put_Record",
   "data": {
    "name": "Put Record",
    "description": "",
    "tasks": [
     {
      "id": "LogMessage",
      "name": "LogMessage",
      "activity": {
       "ref": "github.com/TIBCOSoftware/flogo-contrib/activity/log",
       "input": {
        "flowInfo": "false",
        "addToFlow": "false"
       },
       "output": {},
       "mappings": {
        "input": [
         {
          "mapTo": "$INPUT['message']",
          "type": "expression",
          "value": "string.concat(\"Received user_txn_id: \", $flow.parameters.user_txn_id, \"; secret: \", $flow.parameters.transient.secret, \"; pin: \", string.tostring($flow.parameters.transient.pin), \"; txn_id: \", $flow.txID)"
         }
        ]
       }
      }
     },
     {
      "id": "Return",
      "name": "Return",
      "activity": {
       "ref": "github.com/TIBCOSoftware/flogo-contrib/activity/actreturn",
       "input": {
        "mappings": [
         {
          "mapTo": "$INPUT['returns']['txn_id']",
          "type": "assign",
          "value": "$flow.txID"
         },
         {
          "mapTo": "$INPUT['returns']['txn_time']",
          "type": "assign",
          "value": "$flow.txTime"
         },
         {
          "mapTo": "$INPUT['returns']['user_txn_id']",
          "type": "assign",
          "value": "$flow.parameters.user_txn_id"
         },
         {
          "mapTo": "$INPUT['returns']['data']",
          "type": "assign",
          "value": "$flow.parameters.data"
         },
         {
          "mapTo": "$INPUT['returns']['hash_type']",
          "type": "assign",
          "value": "$flow.parameters.hash_type"
         },
         {
          "mapTo": "$INPUT['returns']['hash_value']",
          "type": "assign",
          "value": "$flow.parameters.hash_value"
         }
        ]
       },
       "output": {}
      }
     }
    ],
    "links": [
     {
      "id": 1,
      "from": "LogMessage",
      "to": "Return",
      "type": "default"
     }
    ],
    "metadata": {
     "input": [
      {
       "name": "parameters",
       "type": "complex_object",
       "value": {
        "value": "",
        "metadata": "{\"user_txn_id\":{\"type\":\"string\"},\"data\":{\"type\":\"string\"},\"hash_type\":{\"type\":\"string\"},\"hash_value\":{\"type\":\"string\"},\"transient\":{\"type\":\"object\",\"properties\":{\"secret\":{\"type\":\"string\"},\"pin\":{\"type\":\"number\"}}}}"
       }
      },
      {
       "name": "txID",
       "type": "string"
      },
      {
       "name": "txTime",
       "type": "string"
      }
     ],
     "output": [
      {
       "name": "returns",
       "type": "complex_object",
       "value": {
        "value": "",
        "metadata": "{\"txn_id\":{\"type\":\"string\"},\"txn_time\":{\"type\":\"string\"},\"user_txn_id\":{\"type\":\"string\"},\"data\":{\"type\":\"string\"},\"hash_type\":{\"type\":\"string\"},\"hash_value\":{\"type\":\"string\"}}"
       }
      }
     ]
    }
   }
  },
  {
   "id": "flow:Put_Records",
   "data": {
    "name": "Put Records",
    "description": "",
    "tasks": [
     {
      "id": "LogMessage1",
      "name": "LogMessage1",
      "activity": {
       "ref": "github.com/TIBCOSoftware/flogo-contrib/activity/log",
       "input": {
        "flowInfo": "false",
        "addToFlow": "false"
       },
       "output": {},
       "mappings": {
        "input": [
         {
          "mapTo": "$INPUT['message']",
          "type": "expression",
          "value": "string.concat(\"received put_records user_txn_id: \", $flow.parameters.records[0].user_txn_id, \"; secret: \", $flow.parameters.transient.secret, \"; txn_id: \", $flow.txID)"
         }
        ]
       }
      }
     },
     {
      "id": "Return1",
      "name": "Return1",
      "activity": {
       "ref": "github.com/TIBCOSoftware/flogo-contrib/activity/actreturn",
       "input": {
        "mappings": [
         {
          "mapTo": "$INPUT['returns']",
          "type": "array",
          "value": "{\"to\":\"$INPUT['returns']\",\"from\":\"$flow.parameters.records\",\"type\":\"foreach\",\"fields\":[{\"to\":\"$INPUT.$$['txn_id']\",\"from\":\"$flow.txID\",\"type\":\"assign\"},{\"to\":\"$INPUT.$$['txn_time']\",\"from\":\"$flow.txTime\",\"type\":\"assign\"},{\"to\":\"$INPUT.$$['user_txn_id']\",\"from\":\"$.user_txn_id\",\"type\":\"assign\"},{\"to\":\"$INPUT.$$['data']\",\"from\":\"$.data\",\"type\":\"assign\"},{\"to\":\"$INPUT.$$['hash_type']\",\"from\":\"SHA256\",\"type\":\"literal\"},{\"to\":\"$INPUT.$$['hash_value']\",\"from\":\"hash-generated\",\"type\":\"literal\"}]}"
         }
        ]
       },
       "output": {}
      }
     }
    ],
    "links": [
     {
      "id": 1,
      "from": "LogMessage1",
      "to": "Return1",
      "type": "default"
     }
    ],
    "metadata": {
     "input": [
      {
       "name": "parameters",
       "type": "complex_object",
       "value": {
        "value": "",
        "metadata": "{\"records\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"user_txn_id\":{\"type\":\"string\"},\"data\":{\"type\":\"string\"}}}},\"transient\":{\"type\":\"object\",\"properties\":{\"secret\":{\"type\":\"string\"}}}}"
       }
      },
      {
       "name": "txID",
       "type": "string"
      },
      {
       "name": "txTime",
       "type": "string"
      }
     ],
     "output": [
      {
       "name": "returns",
       "type": "array"
      }
     ]
    }
   }
  }
 ],
 "triggers": [
  {
   "ref": "github.com/yxuco/flogo-enterprise-app/fabric/trigger/transaction",
   "name": "HyperledgerFabricTransaction",
   "description": "",
   "settings": {},
   "id": "HyperledgerFabricTransaction",
   "handlers": [
    {
     "description": "",
     "settings": {
      "name": "put_record",
      "validation": false
     },
     "outputs": {
      "parameters": {
       "metadata": "{\"$schema\":\"http://json-schema.org/draft-04/schema#\",\"type\":\"object\",\"properties\":{\"user_txn_id\":{\"type\":\"string\"},\"data\":{\"type\":\"string\"},\"hash_type\":{\"type\":\"string\"},\"hash_value\":{\"type\":\"string\"},\"transient\":{\"type\":\"object\",\"properties\":{\"secret\":{\"type\":\"string\"},\"pin\":{\"type\":\"number\"}}}}}",
       "value": ""
      },
      "txID": "",
      "txTime": "",
      "_chaincode_stub": ""
     },
     "action": {
      "ref": "github.com/TIBCOSoftware/flogo-contrib/action/flow",
      "data": {
       "flowURI": "res://flow:Put_Record"
      },
      "mappings": {
       "input": [
        {
         "mapTo": "$INPUT['parameters']['user_txn_id']",
         "type": "assign",
         "value": "$.parameters.user_txn_id"
        },
        {
         "mapTo": "$INPUT['parameters']['data']",
         "type": "assign",
         "value": "$.parameters.data"
        },
        {
         "mapTo": "$INPUT['parameters']['hash_type']",
         "type": "assign",
         "value": "$.parameters.hash_type"
        },
        {
         "mapTo": "$INPUT['parameters']['hash_value']",
         "type": "assign",
         "value": "$.parameters.hash_value"
        },
        {
         "mapTo": "$INPUT['parameters']['transient']['secret']",
         "type": "assign",
         "value": "$.parameters.transient.secret"
        },
        {
         "mapTo": "$INPUT['parameters']['transient']['pin']",
         "type": "assign",
         "value": "$.parameters.transient.pin"
        },
        {
         "mapTo": "$INPUT['txID']",
         "type": "assign",
         "value": "$.txID"
        },
        {
         "mapTo": "$INPUT['txTime']",
         "type": "assign",
         "value": "$.txTime"
        }
       ],
       "output": [
        {
         "mapTo": "$INPUT['returns']['txn_id']",
         "type": "assign",
         "value": "$.returns.txn_id"
        },
        {
         "mapTo": "$INPUT['returns']['txn_time']",
         "type": "assign",
         "value": "$.returns.txn_time"
        },
        {
         "mapTo": "$INPUT['returns']['user_txn_id']",
         "type": "assign",
         "value": "$.returns.user_txn_id"
        },
        {
         "mapTo": "$INPUT['returns']['data']",
         "type": "assign",
         "value": "$.returns.data"
        },
        {
         "mapTo": "$INPUT['returns']['hash_type']",
         "type": "assign",
         "value": "$.returns.hash_type"
        },
        {
         "mapTo": "$INPUT['returns']['hash_value']",
         "type": "assign",
         "value": "$.returns.hash_value"
        }
       ]
      }
     }
    },
    {
     "description": "",
     "settings": {
      "name": "put_records",
      "validation": false
     },
     "outputs": {
      "parameters": {
       "metadata": "{\"$schema\":\"http://json-schema.org/draft-04/schema#\",\"type\":\"object\",\"properties\":{\"records\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"user_txn_id\":{\"type\":\"string\"},\"data\":{\"type\":\"string\"}}}},\"transient\":{\"type\":\"object\",\"properties\":{\"secret\":{\"type\":\"string\"}}}}}",
       "value": ""
      },
      "txID": "",
      "txTime": "",
      "_chaincode_stub": ""
     },
     "action": {
      "ref": "github.com/TIBCOSoftware/flogo-contrib/action/flow",
      "data": {
       "flowURI": "res://flow:Put_Records"
      },
      "mappings": {
       "input": [
        {
         "mapTo": "$INPUT['parameters']['records']",
         "type": "array",
         "value": "{\"to\":\"$INPUT['parameters']['records']\",\"from\":\"$.parameters.records\",\"type\":\"foreach\",\"fields\":[{\"to\":\"$INPUT.$$['user_txn_id']\",\"from\":\"$.user_txn_id\",\"type\":\"assign\"},{\"to\":\"$INPUT.$$['data']\",\"from\":\"$.data\",\"type\":\"assign\"}]}"
        },
        {
         "mapTo": "$INPUT['parameters']['transient']['secret']",
         "type": "assign",
         "value": "$.parameters.transient.secret"
        },
        {
         "mapTo": "$INPUT['txID']",
         "type": "assign",
         "value": "$.txID"
        },
        {
         "mapTo": "$INPUT['txTime']",
         "type": "assign",
         "value": "$.txTime"
        }
       ],
       "output": [
        {
         "mapTo": "$INPUT['returns']",
         "type": "array",
         "value": "{\"to\":\"$INPUT['returns']\",\"from\":\"$.returns\",\"type\":\"foreach\",\"fields\":[{\"to\":\"$INPUT.$$['txn_id']\",\"from\":\"$.txn_id\",\"type\":\"assign\"},{\"to\":\"$INPUT.$$['txn_time']\",\"from\":\"$.txn_time\",\"type\":\"assign\"},{\"to\":\"$INPUT.$$['user_txn_id']\",\"from\":\"$.user_txn_id\",\"type\":\"assign\"},{\"to\":\"$INPUT.$$['data']\",\"from\":\"$.data\",\"type\":\"assign\"},{\"to\":\"$INPUT.$$['hash_type']\",\"from\":\"$.hash_type\",\"type\":\"assign\"},{\"to\":\"$INPUT.$$['hash_value']\",\"from\":\"$.hash_value\",\"type\":\"assign\"}]}"
        }
       ]
      }
     }
    }
   ]
  }
 ],
 "properties": [],
 "ui": "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",
 "contrib": "W3sicmVmIjoiZ2l0aHViLmNvbS95eHVjby9mbG9nby1lbnRlcnByaXNlLWFwcC9mYWJyaWMiLCJzM2xvY2F0aW9uIjoie1VTRVJJRH0vZmFicmljIn0seyJyZWYiOiJnaXRodWIuY29tL1RJQkNPU29mdHdhcmUvZmxvZ28tY29udHJpYi9hY3Rpdml0eS9sb2ciLCJzM2xvY2F0aW9uIjoie1VTRVJJRH0vRGVmYXVsdC9hY3Rpdml0eS9sb2cifV0="
}